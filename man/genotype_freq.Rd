% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/genotype_analysis.R
\name{genotype_freq}
\alias{genotype_freq}
\title{Genotype Frequency Analysis Across TCGA Cancer Projects}
\usage{
genotype_freq(allele1, data, allele2 = NULL, project_filter = NULL)
}
\arguments{
\item{allele1}{A string specifying the primary HLA allele to analyze (e.g., "A*02:01", "B*51:07", "C*20:04").}

\item{data}{A data frame containing HLA allele data with the following structure:
- Columns for HLA alleles (e.g., "A_allele1", "A_allele2", "B_allele1", "B_allele2", "C_allele1", "C_allele2").
- A project_id column indicating TCGA project identifiers.
The dataset named `data` is included in the package as an example dataset.}

\item{allele2}{(Optional) A string specifying a second allele to analyze a specific genotype
(e.g., "A*11:01", "B*27:05", "C*07:02"). Defaults to NULL.}

\item{project_filter}{(Optional) A string specifying a TCGA project ID to filter results (e.g., "TCGA-BRCA").
If provided, a vertical bar plot of genotype frequencies for the specified project is generated. Defaults to NULL.}
}
\value{
A list containing:
  - results_table: A data frame of genotype frequencies, including:
      - project_id: TCGA project identifiers.
      - genotype: The specific genotype (e.g., "A*02:01 - A*11:01").
      - count: The number of samples with the given genotype in the project.
      - total_count: The total number of samples in the project.
      - frequency: The frequency of the genotype within the project.
  - plot: A ggplot2 object visualizing the genotype frequencies.
    - For all projects: A stacked bar plot of frequencies by genotype across projects.
    - For a specific project: A vertical bar plot of frequencies for each genotype in the project.
}
\description{
This function analyzes the frequency of genotypes associated with a specific HLA allele across TCGA cancer projects.
It can compute genotype frequencies for all projects or a specific project, and optionally focuses on a specific genotype
(when a second allele is provided). The output includes a table of genotype frequencies and a customizable plot.
}
\examples{
# Analyze all genotypes associated with "A*11:01" across projects
result <- genotype_freq("A*11:01", data)
print(result$results_table)

# Analyze the specific genotype "A*11:01 - A*02:01" across projects
result_specific <- genotype_freq("A*11:01", data, allele2 = "A*02:01")
print(result_specific$results_table)

# Analyze all genotypes associated with "A*11:01" in a specific project
result_project <- genotype_freq("A*11:01", data, project_filter = "TCGA-LIHC")
print(result_project$results_table)

}
